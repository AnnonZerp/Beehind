Imports Beehind.Common_Definitions
Imports Beehind.Common_Functions
Imports Beehind.IPSWsMD5

Public Class iFaithMode
    '0x1 = datacenter
    '0x2 = factory

    'iPod2,1 datacenter certificate
    Public Const s5l8720x_datacenter_certificate = "8007000074070000308203F8308202E0A003020102020110300D06092A864886F70D01010505003062310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F72697479311630140603550403130D4170706C6520526F6F74204341301E170D3037303130353139323135395A170D3232303130353139323135395A307E310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F7269747931323030060355040313294170706C652053656375726520426F6F742043657274696669636174696F6E20417574686F7269747930820122300D06092A864886F70D01010105000382010F003082010A0282010100FEF2DDDA6539B072E3038481F456C9D1A14ABBC80401F3460D95E137950A6947C6C48C793E475506B20614EB7EA4F523FE423598EF3405CE9AD3AD94D0A20FC2D2B404484C235A5BC70B9D62D3F3E36B10FE970857C612767719B2C6C32C98EDB72987E4DC18B6E5F3BA13FBB2B6B767D9CBDF6FA5933DED7A9367B4FD3416E400AB0BB74E1F5AD603683E72B614303A0C6497A04622791B772C5B2E90E011DC16A3E1C8F784B24FDC4B3A0AD5127EDC113FFA1173651A4970A07E7582B43C2B2F55DF3088B1754D45DC07282D4A3A85FD9F953E22BA9C46F7B7687BB394D5423E05B338F86779488C6C1F8BBEEEED5405D5A30B587D780F24A9A1DC0A74EAF70203010001A3819C308199300E0603551D0F0101FF040403020186300F0603551D130101FF040530030101FF301D0603551D0E04160414493D3653C9D715E186614EACABAB1856635DC3C6301F0603551D230418301680142BD06947947609FEF46B8D2E40A6F7474D7F085E30360603551D1F042F302D302BA029A0278625687474703A2F2F7777772E6170706C652E636F6D2F6170706C6563612F726F6F742E63726C300D06092A864886F70D0101050500038201010034C50CC50E59112FA6C29F3278E7643269DBADC225CAB74783B7923C7153A0B2AD30958050BD6D5F4CDCCE780D4C491050381035BF4581AC66582C2123F8965E80E9D3C64CFD85AE3961F628AA44ED159B3F47C057AC671C8CCDD4938D4FDB6A54A77B425B0F99C6D738AB52A7A1831D853074EA0D1DDA68848FE2847ECBB9416ED59FA842B5FF33B6717FEAA3B9DD4903608576103E8EA8E136E312DD856CED6653B05B489B2F7FF6CA1CF05D982D74ADF04847C5E19A67B2220FB00E02A0E1BA6A62B9B4B571F425E1B3E5A0EDC81A40B5F8311505A45C38234C909D47038080D43290458F0FAF9BFC02EEEDCBE631F69F15E67D2B57430EE20FA1A0AD89DA308203743082025CA0030201020202009F300D06092A864886F70D0101050500307E310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F7269747931323030060355040313294170706C652053656375726520426F6F742043657274696669636174696F6E20417574686F72697479301E170D3039303332353230353235325A170D3139303332363230353235325A3054310B300906035504061302555331133011060355040A130A4170706C6520496E632E310C300A060355040B130345545331223020060355040313194D322D44617277696E2D50726F642D4461746143656E74657230819F300D06092A864886F70D010101050003818D0030818902818100B1208A4803F7B4E17E34BA35A477390F23E29FB57305C93CDF2E0228576C8AB11AAEF723A4F0C912EA97D0FDA3EB2ADD3D3F5C714554ED9897679F47D148BADD273D20DAD5C8E531CEF318BA691B49AD94D0BD62D1C332172E9591778D6E8D1F551B98B97AD26A2C9AA7BCBA33785769B8431D5C043F530B0C20F1D98FA25AE70203010001A381A93081A6300B0603551D0F040403020780301D0603551D0E041604142F7C89355F4FB901101F8EA56F075CD693EC407A301F0603551D23041830168014493D3653C9D715E186614EACABAB1856635DC3C63057060A2A864886F763640601010101FF0446044433676D49440000003000000000000000747265634D4F4453100000000400000001000000444F525010000000040000000100000050494843100000000400000020870000300D06092A864886F70D010105050003820101005F68C18EAA35236D3A70F43A1C60A36F360BC712C7AC810AB2410F1B1F78690378F36284A65BE5D447F7AC90C9302AE749822A5CC16981CAF66363737699E1190225B390420F2E276B8EDE4F3D9B8E1AE165A7EE1733BC2F1507ECDBD5451EBEB07C59244B7BE733D1039502BBF093A5F2E9FD5E410E05F60D80D53CB7F73D7A849C379616358E6C964C11E46ADBC217BF679C6768CF4DB00B9C65EC7A4CCA7C3EC39358F2F54DD4AFCE65D27C994285452126EAB41AF3262FEBC38603A3CDBDD2CA0F6A48F2045F76CECD1390620185B5B3C6D0BB541034EFFDF5102A9FA85ACABC1351DAC4CA3120D4C9FB71412DA7DE9F785552E9DF5D3961CB234CA43CA8"
    'iPod2,1 factory certificate
    Public Const s5l8720x_factory_certificate = "870700007B070000308203F8308202E0A003020102020110300D06092A864886F70D01010505003062310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F72697479311630140603550403130D4170706C6520526F6F74204341301E170D3037303130353139323135395A170D3232303130353139323135395A307E310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F7269747931323030060355040313294170706C652053656375726520426F6F742043657274696669636174696F6E20417574686F7269747930820122300D06092A864886F70D01010105000382010F003082010A0282010100FEF2DDDA6539B072E3038481F456C9D1A14ABBC80401F3460D95E137950A6947C6C48C793E475506B20614EB7EA4F523FE423598EF3405CE9AD3AD94D0A20FC2D2B404484C235A5BC70B9D62D3F3E36B10FE970857C612767719B2C6C32C98EDB72987E4DC18B6E5F3BA13FBB2B6B767D9CBDF6FA5933DED7A9367B4FD3416E400AB0BB74E1F5AD603683E72B614303A0C6497A04622791B772C5B2E90E011DC16A3E1C8F784B24FDC4B3A0AD5127EDC113FFA1173651A4970A07E7582B43C2B2F55DF3088B1754D45DC07282D4A3A85FD9F953E22BA9C46F7B7687BB394D5423E05B338F86779488C6C1F8BBEEEED5405D5A30B587D780F24A9A1DC0A74EAF70203010001A3819C308199300E0603551D0F0101FF040403020186300F0603551D130101FF040530030101FF301D0603551D0E04160414493D3653C9D715E186614EACABAB1856635DC3C6301F0603551D230418301680142BD06947947609FEF46B8D2E40A6F7474D7F085E30360603551D1F042F302D302BA029A0278625687474703A2F2F7777772E6170706C652E636F6D2F6170706C6563612F726F6F742E63726C300D06092A864886F70D0101050500038201010034C50CC50E59112FA6C29F3278E7643269DBADC225CAB74783B7923C7153A0B2AD30958050BD6D5F4CDCCE780D4C491050381035BF4581AC66582C2123F8965E80E9D3C64CFD85AE3961F628AA44ED159B3F47C057AC671C8CCDD4938D4FDB6A54A77B425B0F99C6D738AB52A7A1831D853074EA0D1DDA68848FE2847ECBB9416ED59FA842B5FF33B6717FEAA3B9DD4903608576103E8EA8E136E312DD856CED6653B05B489B2F7FF6CA1CF05D982D74ADF04847C5E19A67B2220FB00E02A0E1BA6A62B9B4B571F425E1B3E5A0EDC81A40B5F8311505A45C38234C909D47038080D43290458F0FAF9BFC02EEEDCBE631F69F15E67D2B57430EE20FA1A0AD89DA3082037B30820263A003020102020200AD300D06092A864886F70D0101050500307E310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F7269747931323030060355040313294170706C652053656375726520426F6F742043657274696669636174696F6E20417574686F72697479301E170D3039303430313138313035355A170D3139303430323138313035355A305B310B300906035504061302555331133011060355040A130A4170706C6520496E632E310C300A060355040B130345545331293027060355040313204D322D44617277696E2D50726F642D466163746F72792E2E2E2E2E2E2E2E2E2E30819F300D06092A864886F70D010101050003818D00308189028181009E914618A34C65319C5674E600D8066440554BF4D86967C082249B18924DED69FE64D142E1322D643409DF866723C26B57CFE3923727B1EDE08C05B8354C0ABF3E10E92CDAB1AF704AF56174CB8B7CDABE2F07EA7F49F12AEE5DB4024833317A03734EBA1FC9AE61C1E07227DE23E743ECF09A72FE72D8478A9B80A8B6E1133F0203010001A381A93081A6300B0603551D0F040403020780301D0603551D0E0416041454383BD1042CAF84B1CA5535E1ED4463CB173AF5301F0603551D23041830168014493D3653C9D715E186614EACABAB1856635DC3C63057060A2A864886F763640601010101FF0446044433676D49440000003000000000000000747265634D4F4453100000000400000001000000444F525010000000040000000100000050494843100000000400000020870000300D06092A864886F70D01010505000382010100AB6200F4646764C2DB5ED6E0B1056A53BBE4994A4F62663C27BC982FE6E12BC81EA497FDCDAE73169CA7446270CA749559891B61337A7735E11C69833F57975D08931C720549335E7A721FD2124D9548B5FBA9657CF32110689CFA12BB0E893E4FF06CBDD68550C277604D0C8E3CC99907B5E28E2FED8AD77A25455D2C2D09A382B245E460B6FE51D603C37BD6155C825402AADBE005A424F5E03111794B637B7E57A28D089679EBFEE95458D2D68E12D29BAD079B4F93017E59A9F613AFD459CB6129E57182EEFEA193D0B2971A9853BBBBFA5B3AADEB3E716E2A12E3509F72B4D5350D617C2B39E54E84BCFCEF650BB29DFFA2CCF603672CC0A49BB670BED3"

    'iPhone2,1 datacenter certificate
    Public Const s5l8920x_datacenter_certificate = "8107000075070000308203F8308202E0A003020102020110300D06092A864886F70D01010505003062310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F72697479311630140603550403130D4170706C6520526F6F74204341301E170D3037303130353139323135395A170D3232303130353139323135395A307E310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F7269747931323030060355040313294170706C652053656375726520426F6F742043657274696669636174696F6E20417574686F7269747930820122300D06092A864886F70D01010105000382010F003082010A0282010100FEF2DDDA6539B072E3038481F456C9D1A14ABBC80401F3460D95E137950A6947C6C48C793E475506B20614EB7EA4F523FE423598EF3405CE9AD3AD94D0A20FC2D2B404484C235A5BC70B9D62D3F3E36B10FE970857C612767719B2C6C32C98EDB72987E4DC18B6E5F3BA13FBB2B6B767D9CBDF6FA5933DED7A9367B4FD3416E400AB0BB74E1F5AD603683E72B614303A0C6497A04622791B772C5B2E90E011DC16A3E1C8F784B24FDC4B3A0AD5127EDC113FFA1173651A4970A07E7582B43C2B2F55DF3088B1754D45DC07282D4A3A85FD9F953E22BA9C46F7B7687BB394D5423E05B338F86779488C6C1F8BBEEEED5405D5A30B587D780F24A9A1DC0A74EAF70203010001A3819C308199300E0603551D0F0101FF040403020186300F0603551D130101FF040530030101FF301D0603551D0E04160414493D3653C9D715E186614EACABAB1856635DC3C6301F0603551D230418301680142BD06947947609FEF46B8D2E40A6F7474D7F085E30360603551D1F042F302D302BA029A0278625687474703A2F2F7777772E6170706C652E636F6D2F6170706C6563612F726F6F742E63726C300D06092A864886F70D0101050500038201010034C50CC50E59112FA6C29F3278E7643269DBADC225CAB74783B7923C7153A0B2AD30958050BD6D5F4CDCCE780D4C491050381035BF4581AC66582C2123F8965E80E9D3C64CFD85AE3961F628AA44ED159B3F47C057AC671C8CCDD4938D4FDB6A54A77B425B0F99C6D738AB52A7A1831D853074EA0D1DDA68848FE2847ECBB9416ED59FA842B5FF33B6717FEAA3B9DD4903608576103E8EA8E136E312DD856CED6653B05B489B2F7FF6CA1CF05D982D74ADF04847C5E19A67B2220FB00E02A0E1BA6A62B9B4B571F425E1B3E5A0EDC81A40B5F8311505A45C38234C909D47038080D43290458F0FAF9BFC02EEEDCBE631F69F15E67D2B57430EE20FA1A0AD89DA308203753082025DA003020102020200A4300D06092A864886F70D0101050500307E310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F7269747931323030060355040313294170706C652053656375726520426F6F742043657274696669636174696F6E20417574686F72697479301E170D3039303332353230353235325A170D3139303332363230353235325A3055310B300906035504061302555331133011060355040A130A4170706C6520496E632E310C300A060355040B1303455453312330210603550403131A4832502D44617277696E2D50726F642D4461746143656E74657230819F300D06092A864886F70D010101050003818D0030818902818100AD4D7EBD3B651D74DD0966B1891897C709D9ACA8B05402DE4667148A2D1FD36D2981FAFFC06AB80BAE9129542790D94BE23AD8396B884A0393CA03D69A775ED125B4B286446A2343CDA228111EF6336DE85BA5C2148C691111FFBC7483FBA64FA38C63DAC1F12AC18DFA64E44338671B3107FFFDF75B8F41D398A95CDB61E6430203010001A381A93081A6300B0603551D0F040403020780301D0603551D0E041604144DDCB87B5E06E5D097795AADE420A7ED0682C362301F0603551D23041830168014493D3653C9D715E186614EACABAB1856635DC3C63057060A2A864886F763640601010101FF0446044433676D49440000003000000000000000747265634D4F4453100000000400000001000000444F525010000000040000000100000050494843100000000400000020890000300D06092A864886F70D010105050003820101006AB42C5993F97F9FD0C6C02FC2F9FD1ABC3DD9A4688EBFDE58CF27468CD213D666BFF5F2F960BD2AA200995883C6FBA0AAFED8E71285BB740776AEDF575349328C23842A607CC83BC7ECB2CB4AF0AAA4C1186D9AE1E1FA1CAD07E6F898CFE2273B00088ED6980AD6F31FCCDCF5CD405C12CB4625B0E2AB8F7EBCA2E85D687E732337547E5525B7F04BEA95734B49A39709FC1F7DA68082D96C1940DC0EE443584BF74B00E727C2E9868567D0038F6B29085364665ADE8668BB0E0FA5DC983237B1324C7D9ABD5DEA0BECECC45C95BFA360A778560241EFBD30ACF7DD39684A367FDC4DD8C3240CAC2C2E867E74F0037FA974E71BF1BE7721E97BE039239C1C63"
    'iPhone2,1 factory certificate
    Public Const s5l8920x_factory_certificate = "870700007B070000308203F8308202E0A003020102020110300D06092A864886F70D01010505003062310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F72697479311630140603550403130D4170706C6520526F6F74204341301E170D3037303130353139323135395A170D3232303130353139323135395A307E310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F7269747931323030060355040313294170706C652053656375726520426F6F742043657274696669636174696F6E20417574686F7269747930820122300D06092A864886F70D01010105000382010F003082010A0282010100FEF2DDDA6539B072E3038481F456C9D1A14ABBC80401F3460D95E137950A6947C6C48C793E475506B20614EB7EA4F523FE423598EF3405CE9AD3AD94D0A20FC2D2B404484C235A5BC70B9D62D3F3E36B10FE970857C612767719B2C6C32C98EDB72987E4DC18B6E5F3BA13FBB2B6B767D9CBDF6FA5933DED7A9367B4FD3416E400AB0BB74E1F5AD603683E72B614303A0C6497A04622791B772C5B2E90E011DC16A3E1C8F784B24FDC4B3A0AD5127EDC113FFA1173651A4970A07E7582B43C2B2F55DF3088B1754D45DC07282D4A3A85FD9F953E22BA9C46F7B7687BB394D5423E05B338F86779488C6C1F8BBEEEED5405D5A30B587D780F24A9A1DC0A74EAF70203010001A3819C308199300E0603551D0F0101FF040403020186300F0603551D130101FF040530030101FF301D0603551D0E04160414493D3653C9D715E186614EACABAB1856635DC3C6301F0603551D230418301680142BD06947947609FEF46B8D2E40A6F7474D7F085E30360603551D1F042F302D302BA029A0278625687474703A2F2F7777772E6170706C652E636F6D2F6170706C6563612F726F6F742E63726C300D06092A864886F70D0101050500038201010034C50CC50E59112FA6C29F3278E7643269DBADC225CAB74783B7923C7153A0B2AD30958050BD6D5F4CDCCE780D4C491050381035BF4581AC66582C2123F8965E80E9D3C64CFD85AE3961F628AA44ED159B3F47C057AC671C8CCDD4938D4FDB6A54A77B425B0F99C6D738AB52A7A1831D853074EA0D1DDA68848FE2847ECBB9416ED59FA842B5FF33B6717FEAA3B9DD4903608576103E8EA8E136E312DD856CED6653B05B489B2F7FF6CA1CF05D982D74ADF04847C5E19A67B2220FB00E02A0E1BA6A62B9B4B571F425E1B3E5A0EDC81A40B5F8311505A45C38234C909D47038080D43290458F0FAF9BFC02EEEDCBE631F69F15E67D2B57430EE20FA1A0AD89DA3082037B30820263A003020102020200B2300D06092A864886F70D0101050500307E310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F7269747931323030060355040313294170706C652053656375726520426F6F742043657274696669636174696F6E20417574686F72697479301E170D3039303430313138313035365A170D3139303430323138313035365A305B310B300906035504061302555331133011060355040A130A4170706C6520496E632E310C300A060355040B130345545331293027060355040313204832502D44617277696E2D50726F642D466163746F72792E2E2E2E2E2E2E2E2E30819F300D06092A864886F70D010101050003818D00308189028181009BDFEBBD829BF7219062CF000FF436E361475780F973360260796BC3A7C02D119B727329E7FF6E1C9E07F80E53D935F6C2C15FB1319CC2C38051DC2DA9B302306040B359B1A3436C93EBFB360637730DAC7C11A562B1259B0FF952BF0236527CA5A5091A58E93B3848D921E4ACD04D0F2BE15C1DD6D25FAD455D11B7D34396C30203010001A381A93081A6300B0603551D0F040403020780301D0603551D0E04160414CAB12D87EE9AFE2823373161F5BB4ED10604C796301F0603551D23041830168014493D3653C9D715E186614EACABAB1856635DC3C63057060A2A864886F763640601010101FF0446044433676D49440000003000000000000000747265634D4F4453100000000400000001000000444F525010000000040000000100000050494843100000000400000020890000300D06092A864886F70D01010505000382010100491617A0E881CC10986BC3CB6B6F0ADBA92AFC7ADC2B70709DDA43C28C0D1E946E5D3B69F106FC87F11D6277B7ACBE702C07EEC7F9B2D338928722310DBBD8D6E696F40CC92C9960BCDE9AC04B9703BE32298DC68C61D6F841C39F0901C14A63EE25B29261F690C403FF4584AB227C226543C3B6A2B31E6FC6D3387D606E74A661C238C275A448A701575103781C669D9D374F4A5F3FE7E481B9DF16AAD10869805BD0B58AB459CDE4BFA5F26ED3C6A618E6F4E4870E8E7EF7F261F04B69879DEB55119B28A9F29DCB8348968515CAF9846B7DEE86F4679AB20ED03D0A236C67247332D23B1D7F5D46867D392929C69B432CAACAB4CF515939211F29C758297C"

    'iPod3,1 datacenter certificate
    Public Const s5l8922x_datacenter_certificate = "8107000075070000308203F8308202E0A003020102020110300D06092A864886F70D01010505003062310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F72697479311630140603550403130D4170706C6520526F6F74204341301E170D3037303130353139323135395A170D3232303130353139323135395A307E310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F7269747931323030060355040313294170706C652053656375726520426F6F742043657274696669636174696F6E20417574686F7269747930820122300D06092A864886F70D01010105000382010F003082010A0282010100FEF2DDDA6539B072E3038481F456C9D1A14ABBC80401F3460D95E137950A6947C6C48C793E475506B20614EB7EA4F523FE423598EF3405CE9AD3AD94D0A20FC2D2B404484C235A5BC70B9D62D3F3E36B10FE970857C612767719B2C6C32C98EDB72987E4DC18B6E5F3BA13FBB2B6B767D9CBDF6FA5933DED7A9367B4FD3416E400AB0BB74E1F5AD603683E72B614303A0C6497A04622791B772C5B2E90E011DC16A3E1C8F784B24FDC4B3A0AD5127EDC113FFA1173651A4970A07E7582B43C2B2F55DF3088B1754D45DC07282D4A3A85FD9F953E22BA9C46F7B7687BB394D5423E05B338F86779488C6C1F8BBEEEED5405D5A30B587D780F24A9A1DC0A74EAF70203010001A3819C308199300E0603551D0F0101FF040403020186300F0603551D130101FF040530030101FF301D0603551D0E04160414493D3653C9D715E186614EACABAB1856635DC3C6301F0603551D230418301680142BD06947947609FEF46B8D2E40A6F7474D7F085E30360603551D1F042F302D302BA029A0278625687474703A2F2F7777772E6170706C652E636F6D2F6170706C6563612F726F6F742E63726C300D06092A864886F70D0101050500038201010034C50CC50E59112FA6C29F3278E7643269DBADC225CAB74783B7923C7153A0B2AD30958050BD6D5F4CDCCE780D4C491050381035BF4581AC66582C2123F8965E80E9D3C64CFD85AE3961F628AA44ED159B3F47C057AC671C8CCDD4938D4FDB6A54A77B425B0F99C6D738AB52A7A1831D853074EA0D1DDA68848FE2847ECBB9416ED59FA842B5FF33B6717FEAA3B9DD4903608576103E8EA8E136E312DD856CED6653B05B489B2F7FF6CA1CF05D982D74ADF04847C5E19A67B2220FB00E02A0E1BA6A62B9B4B571F425E1B3E5A0EDC81A40B5F8311505A45C38234C909D47038080D43290458F0FAF9BFC02EEEDCBE631F69F15E67D2B57430EE20FA1A0AD89DA308203753082025DA003020102020200A7300D06092A864886F70D0101050500307E310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F7269747931323030060355040313294170706C652053656375726520426F6F742043657274696669636174696F6E20417574686F72697479301E170D3039303332353230353235325A170D3139303332363230353235325A3055310B300906035504061302555331133011060355040A130A4170706C6520496E632E310C300A060355040B1303455453312330210603550403131A4832412D44617277696E2D50726F642D4461746143656E74657230819F300D06092A864886F70D010101050003818D0030818902818100A8693DFAEC019204EC63A6C9EFC7814AA57B9FFBE73B074994D648033947C85D9FB0A7F1D89419021373848D13AACDBA46663A659AB5DA7A5DA4F4CEF0E5D48F299355BFDE234A0EA2DC07F3F5A7AA86766448753F460523B3531C23D36B46403882D65519BDA8B66B36BE68FDC4F19766D48D661EA72E7E27F8A3D8745287750203010001A381A93081A6300B0603551D0F040403020780301D0603551D0E04160414E24E3A0E1B92221F33AC8E11C69851C786ABDFA9301F0603551D23041830168014493D3653C9D715E186614EACABAB1856635DC3C63057060A2A864886F763640601010101FF0446044433676D49440000003000000000000000747265634D4F4453100000000400000001000000444F525010000000040000000100000050494843100000000400000022890000300D06092A864886F70D01010505000382010100BBC2803059355CD4D5D5D4EE987A96F47CCCC77B8E6A7076494B1DC7AE12B90A850516879771ECE0E7F8FE73CD7600FC2D0AF26EE2845695A5D0A672EC006AA9FAEC28C6B4B2EA58734DB80A15FE8A085C82AEF7AEA1185E471DE38DCFFD6762F083277AB919CCE6C3061A1B7B191A1E526E3D19377FE21FDD0C21F0EDB6D74F4AB727F37F5C8FE90C90721241DC25616CAAABDAD48ECE6E3305A488EA5198BDBC1947032DFCFB50EBF65DDD0BB81E0AB17859ADBBCF47CF3D8AE012D1D35CB79984F30695BF235217D1EE525FCC81F3FFE01EE9366B43F8079ECFB358BEB69F21806CC5137AD9A388810176D829AAA9B2CF7FC0AC81E7B6CBC11710B15ADB57"
    'iPod3,1 factory certificate
    Public Const s5l8922x_factory_certificate = "870700007B070000308203F8308202E0A003020102020110300D06092A864886F70D01010505003062310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F72697479311630140603550403130D4170706C6520526F6F74204341301E170D3037303130353139323135395A170D3232303130353139323135395A307E310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F7269747931323030060355040313294170706C652053656375726520426F6F742043657274696669636174696F6E20417574686F7269747930820122300D06092A864886F70D01010105000382010F003082010A0282010100FEF2DDDA6539B072E3038481F456C9D1A14ABBC80401F3460D95E137950A6947C6C48C793E475506B20614EB7EA4F523FE423598EF3405CE9AD3AD94D0A20FC2D2B404484C235A5BC70B9D62D3F3E36B10FE970857C612767719B2C6C32C98EDB72987E4DC18B6E5F3BA13FBB2B6B767D9CBDF6FA5933DED7A9367B4FD3416E400AB0BB74E1F5AD603683E72B614303A0C6497A04622791B772C5B2E90E011DC16A3E1C8F784B24FDC4B3A0AD5127EDC113FFA1173651A4970A07E7582B43C2B2F55DF3088B1754D45DC07282D4A3A85FD9F953E22BA9C46F7B7687BB394D5423E05B338F86779488C6C1F8BBEEEED5405D5A30B587D780F24A9A1DC0A74EAF70203010001A3819C308199300E0603551D0F0101FF040403020186300F0603551D130101FF040530030101FF301D0603551D0E04160414493D3653C9D715E186614EACABAB1856635DC3C6301F0603551D230418301680142BD06947947609FEF46B8D2E40A6F7474D7F085E30360603551D1F042F302D302BA029A0278625687474703A2F2F7777772E6170706C652E636F6D2F6170706C6563612F726F6F742E63726C300D06092A864886F70D0101050500038201010034C50CC50E59112FA6C29F3278E7643269DBADC225CAB74783B7923C7153A0B2AD30958050BD6D5F4CDCCE780D4C491050381035BF4581AC66582C2123F8965E80E9D3C64CFD85AE3961F628AA44ED159B3F47C057AC671C8CCDD4938D4FDB6A54A77B425B0F99C6D738AB52A7A1831D853074EA0D1DDA68848FE2847ECBB9416ED59FA842B5FF33B6717FEAA3B9DD4903608576103E8EA8E136E312DD856CED6653B05B489B2F7FF6CA1CF05D982D74ADF04847C5E19A67B2220FB00E02A0E1BA6A62B9B4B571F425E1B3E5A0EDC81A40B5F8311505A45C38234C909D47038080D43290458F0FAF9BFC02EEEDCBE631F69F15E67D2B57430EE20FA1A0AD89DA3082037B30820263A003020102020200B5300D06092A864886F70D0101050500307E310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F7269747931323030060355040313294170706C652053656375726520426F6F742043657274696669636174696F6E20417574686F72697479301E170D3039303430313138313035365A170D3139303430323138313035365A305B310B300906035504061302555331133011060355040A130A4170706C6520496E632E310C300A060355040B130345545331293027060355040313204832412D44617277696E2D50726F642D466163746F72792E2E2E2E2E2E2E2E2E30819F300D06092A864886F70D010101050003818D0030818902818100B487CAA0AC9C7AD25471130189B621E4159E9FE05C3CA2A7AE4AFF5275BDFFB1D3DA6BD45163D90606BE5E9FD460FBEB36DEEBF70C7BD7BD1664BB8920F13A95B0589CCE22BB2ACBA965FF0201599AB92941E44A2CDF4952E676CF2021CC558266F5CD0870264E7FF3824055753E0142D754611706F97E63E3797F1289AD1DF90203010001A381A93081A6300B0603551D0F040403020780301D0603551D0E04160414569F9DC07E92C0D4009CCFBA0328281749F0A8A2301F0603551D23041830168014493D3653C9D715E186614EACABAB1856635DC3C63057060A2A864886F763640601010101FF0446044433676D49440000003000000000000000747265634D4F4453100000000400000001000000444F525010000000040000000100000050494843100000000400000022890000300D06092A864886F70D01010505000382010100AA0A15D09B68624E2141F4CF984754139E365E3DEB225C3BA7CBC83C1407FDA65B04BBF502BFFBC44A6C2550DF842E0CF50A6B281A9273A3C003B98D7C44859072B8BED3A8E2319460C70438E37F3EFEDA29DDB71968CFB37D87489FB6B0B5AD1A26A1CC5C391103319DC67DFFA6CEC823849CC2F73FFE4848436B408F3F9899BABACAB32336C54D9C8732E72B4A9392E969D7033F2E029118B9128CC5DCE4215E6FE3D4611188CE0F40D6D435EA784F07A677E4CB954154A4AE8C452BCA4CEEACD31277F6851B1B712D59A6F0B9C70A9D1C470C08506F06942F59CAF5118C9453BF937A0E9A501309BED2B0255C4890FCABA395E6142FB0CB5212EBA6A311AC"

    'iPod4,1/iPhone3,1/iPhone3,2/iPhone3,3/iPad1,1 datacenter certificate
    Public Const s5l8930x_datacenter_certificate = "8107000075070000308203F8308202E0A003020102020110300D06092A864886F70D01010505003062310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F72697479311630140603550403130D4170706C6520526F6F74204341301E170D3037303130353139323135395A170D3232303130353139323135395A307E310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F7269747931323030060355040313294170706C652053656375726520426F6F742043657274696669636174696F6E20417574686F7269747930820122300D06092A864886F70D01010105000382010F003082010A0282010100FEF2DDDA6539B072E3038481F456C9D1A14ABBC80401F3460D95E137950A6947C6C48C793E475506B20614EB7EA4F523FE423598EF3405CE9AD3AD94D0A20FC2D2B404484C235A5BC70B9D62D3F3E36B10FE970857C612767719B2C6C32C98EDB72987E4DC18B6E5F3BA13FBB2B6B767D9CBDF6FA5933DED7A9367B4FD3416E400AB0BB74E1F5AD603683E72B614303A0C6497A04622791B772C5B2E90E011DC16A3E1C8F784B24FDC4B3A0AD5127EDC113FFA1173651A4970A07E7582B43C2B2F55DF3088B1754D45DC07282D4A3A85FD9F953E22BA9C46F7B7687BB394D5423E05B338F86779488C6C1F8BBEEEED5405D5A30B587D780F24A9A1DC0A74EAF70203010001A3819C308199300E0603551D0F0101FF040403020186300F0603551D130101FF040530030101FF301D0603551D0E04160414493D3653C9D715E186614EACABAB1856635DC3C6301F0603551D230418301680142BD06947947609FEF46B8D2E40A6F7474D7F085E30360603551D1F042F302D302BA029A0278625687474703A2F2F7777772E6170706C652E636F6D2F6170706C6563612F726F6F742E63726C300D06092A864886F70D0101050500038201010034C50CC50E59112FA6C29F3278E7643269DBADC225CAB74783B7923C7153A0B2AD30958050BD6D5F4CDCCE780D4C491050381035BF4581AC66582C2123F8965E80E9D3C64CFD85AE3961F628AA44ED159B3F47C057AC671C8CCDD4938D4FDB6A54A77B425B0F99C6D738AB52A7A1831D853074EA0D1DDA68848FE2847ECBB9416ED59FA842B5FF33B6717FEAA3B9DD4903608576103E8EA8E136E312DD856CED6653B05B489B2F7FF6CA1CF05D982D74ADF04847C5E19A67B2220FB00E02A0E1BA6A62B9B4B571F425E1B3E5A0EDC81A40B5F8311505A45C38234C909D47038080D43290458F0FAF9BFC02EEEDCBE631F69F15E67D2B57430EE20FA1A0AD89DA308203753082025DA003020102020200AA300D06092A864886F70D0101050500307E310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F7269747931323030060355040313294170706C652053656375726520426F6F742043657274696669636174696F6E20417574686F72697479301E170D3039303332353230353235335A170D3139303332363230353235335A3055310B300906035504061302555331133011060355040A130A4170706C6520496E632E310C300A060355040B1303455453312330210603550403131A4833502D44617277696E2D50726F642D4461746143656E74657230819F300D06092A864886F70D010101050003818D0030818902818100E2F2C1036E6679634484E11E81EC0AF1005FE8F3E7D341A501647677D023C89750C88A5636DD9F972755826311F9482A0D6BFCE92C67250F235D33AB62AAE3C1444D549DB5E02BE0B1175FD959C41F3B5012BE3FF5698E19BF335B9EDF5EBD2C34BBF428C134C2A8642F8D8437FE49877A175EDCD7C3B22F6C1B9460538A024F0203010001A381A93081A6300B0603551D0F040403020780301D0603551D0E0416041421A3C0BB490633E9F37F066783F569DC52849F9B301F0603551D23041830168014493D3653C9D715E186614EACABAB1856635DC3C63057060A2A864886F763640601010101FF0446044433676D49440000003000000000000000747265634D4F4453100000000400000001000000444F525010000000040000000100000050494843100000000400000030890000300D06092A864886F70D01010505000382010100F4F6E9E7323F29E82C79C4532D9A49828F32646A5164C14C7FF34565EB52E5B2EF7F6587F9F1811011A297B52FDB8498B556E46992E6EADEF3B6CEA879527A46DE732DF2A9BF0B6F46916228C7E3121073214F1600E2B447EC8CE3F3761D742CE1BAFA494A58DD0DDF28C392E0C610ACEF5D518AC5EFD988582A8F0133C82F54A1DD325323BCE0744B22C9833CDADFA86F61F685A0BA52207C40EE5CAFC87DBE324E972178EF6F3C222DED8852689DABF8639EE85DB3D0B893DBA21D9DC6B5C336ABCF4DA4ED1459B80E9360FAA9C140D550A2AEAE167A36C67832735645AD7F125B4CA33067F7BC374C30D0CE930C911CC34D27ED5FF52B42A87F8396D02AD7"
    'iPod4,1/iPhone3,1/iPhone3,2/iPhone3,3/iPad1,1 factory certificate
    Public Const s5l8930x_factory_certificate = "870700007B070000308203F8308202E0A003020102020110300D06092A864886F70D01010505003062310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F72697479311630140603550403130D4170706C6520526F6F74204341301E170D3037303130353139323135395A170D3232303130353139323135395A307E310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F7269747931323030060355040313294170706C652053656375726520426F6F742043657274696669636174696F6E20417574686F7269747930820122300D06092A864886F70D01010105000382010F003082010A0282010100FEF2DDDA6539B072E3038481F456C9D1A14ABBC80401F3460D95E137950A6947C6C48C793E475506B20614EB7EA4F523FE423598EF3405CE9AD3AD94D0A20FC2D2B404484C235A5BC70B9D62D3F3E36B10FE970857C612767719B2C6C32C98EDB72987E4DC18B6E5F3BA13FBB2B6B767D9CBDF6FA5933DED7A9367B4FD3416E400AB0BB74E1F5AD603683E72B614303A0C6497A04622791B772C5B2E90E011DC16A3E1C8F784B24FDC4B3A0AD5127EDC113FFA1173651A4970A07E7582B43C2B2F55DF3088B1754D45DC07282D4A3A85FD9F953E22BA9C46F7B7687BB394D5423E05B338F86779488C6C1F8BBEEEED5405D5A30B587D780F24A9A1DC0A74EAF70203010001A3819C308199300E0603551D0F0101FF040403020186300F0603551D130101FF040530030101FF301D0603551D0E04160414493D3653C9D715E186614EACABAB1856635DC3C6301F0603551D230418301680142BD06947947609FEF46B8D2E40A6F7474D7F085E30360603551D1F042F302D302BA029A0278625687474703A2F2F7777772E6170706C652E636F6D2F6170706C6563612F726F6F742E63726C300D06092A864886F70D0101050500038201010034C50CC50E59112FA6C29F3278E7643269DBADC225CAB74783B7923C7153A0B2AD30958050BD6D5F4CDCCE780D4C491050381035BF4581AC66582C2123F8965E80E9D3C64CFD85AE3961F628AA44ED159B3F47C057AC671C8CCDD4938D4FDB6A54A77B425B0F99C6D738AB52A7A1831D853074EA0D1DDA68848FE2847ECBB9416ED59FA842B5FF33B6717FEAA3B9DD4903608576103E8EA8E136E312DD856CED6653B05B489B2F7FF6CA1CF05D982D74ADF04847C5E19A67B2220FB00E02A0E1BA6A62B9B4B571F425E1B3E5A0EDC81A40B5F8311505A45C38234C909D47038080D43290458F0FAF9BFC02EEEDCBE631F69F15E67D2B57430EE20FA1A0AD89DA3082037B30820263A003020102020200B8300D06092A864886F70D0101050500307E310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F7269747931323030060355040313294170706C652053656375726520426F6F742043657274696669636174696F6E20417574686F72697479301E170D3039303430313138313035365A170D3139303430323138313035365A305B310B300906035504061302555331133011060355040A130A4170706C6520496E632E310C300A060355040B130345545331293027060355040313204833502D44617277696E2D50726F642D466163746F72792E2E2E2E2E2E2E2E2E30819F300D06092A864886F70D010101050003818D0030818902818100AB39341182D0D6243874BE97F820B6885D23309B723248347EC1DF773A746FC6461BC008386622596D9B69FD537DAE90733FAEF6F001DA52C65199B902DCCED42E761B537143338D793F8AF2318135ACE131E8E11394245C4E9601A5E283EAC634E61274F76ED7A630772DE7CCA1B034AD28FC7013F98A4C91F49E341B670B690203010001A381A93081A6300B0603551D0F040403020780301D0603551D0E04160414BF8074F4135352847355335B7CD95EAFB64094D7301F0603551D23041830168014493D3653C9D715E186614EACABAB1856635DC3C63057060A2A864886F763640601010101FF0446044433676D49440000003000000000000000747265634D4F4453100000000400000001000000444F525010000000040000000100000050494843100000000400000030890000300D06092A864886F70D01010505000382010100397301682D73F7FA878185E18484FFCFBE6671EA0159EF1A67EB069AA83D92BF5A122906AD2FE980387CB90AA1B8528C19DC4BD8AD248F1CD6C6610DCFB088CE76B1991AA24C176EB04354D0278B089F411E90643C934E603EDE2854199B2164E7C9F8DE74B30348D7BB9EE6CEC060CE7D6C9E3CF189EDEEE19B1CC707FD969766E3FD4B3127CD3A4F8DDFF290C1949F0F51A7770B1DD4EC3867930BB9B9CA4D8073D587CF1F01C783AEBF5AF17BD9D3856EA834F213EDF2AA89459DB3EDE3F92F866F94B186522E34D7F3BCFBCACE3E8B310925D5BAB5E8685757DC2B1003A104C093CF5765BC88C609AF94EA4480F61D481356AF2C4E53FB6FF26690557336"

    'iPad2,1/iPad2,2/iPad2,3/iPhone4,1 datacenter certificate
    Public Const s5l8940x_datacenter_certificate = "C2070000B6070000308203F8308202E0A003020102020110300D06092A864886F70D01010505003062310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F72697479311630140603550403130D4170706C6520526F6F74204341301E170D3037303130353139323135395A170D3232303130353139323135395A307E310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F7269747931323030060355040313294170706C652053656375726520426F6F742043657274696669636174696F6E20417574686F7269747930820122300D06092A864886F70D01010105000382010F003082010A0282010100FEF2DDDA6539B072E3038481F456C9D1A14ABBC80401F3460D95E137950A6947C6C48C793E475506B20614EB7EA4F523FE423598EF3405CE9AD3AD94D0A20FC2D2B404484C235A5BC70B9D62D3F3E36B10FE970857C612767719B2C6C32C98EDB72987E4DC18B6E5F3BA13FBB2B6B767D9CBDF6FA5933DED7A9367B4FD3416E400AB0BB74E1F5AD603683E72B614303A0C6497A04622791B772C5B2E90E011DC16A3E1C8F784B24FDC4B3A0AD5127EDC113FFA1173651A4970A07E7582B43C2B2F55DF3088B1754D45DC07282D4A3A85FD9F953E22BA9C46F7B7687BB394D5423E05B338F86779488C6C1F8BBEEEED5405D5A30B587D780F24A9A1DC0A74EAF70203010001A3819C308199300E0603551D0F0101FF040403020186300F0603551D130101FF040530030101FF301D0603551D0E04160414493D3653C9D715E186614EACABAB1856635DC3C6301F0603551D230418301680142BD06947947609FEF46B8D2E40A6F7474D7F085E30360603551D1F042F302D302BA029A0278625687474703A2F2F7777772E6170706C652E636F6D2F6170706C6563612F726F6F742E63726C300D06092A864886F70D0101050500038201010034C50CC50E59112FA6C29F3278E7643269DBADC225CAB74783B7923C7153A0B2AD30958050BD6D5F4CDCCE780D4C491050381035BF4581AC66582C2123F8965E80E9D3C64CFD85AE3961F628AA44ED159B3F47C057AC671C8CCDD4938D4FDB6A54A77B425B0F99C6D738AB52A7A1831D853074EA0D1DDA68848FE2847ECBB9416ED59FA842B5FF33B6717FEAA3B9DD4903608576103E8EA8E136E312DD856CED6653B05B489B2F7FF6CA1CF05D982D74ADF04847C5E19A67B2220FB00E02A0E1BA6A62B9B4B571F425E1B3E5A0EDC81A40B5F8311505A45C38234C909D47038080D43290458F0FAF9BFC02EEEDCBE631F69F15E67D2B57430EE20FA1A0AD89DA308203B63082029EA003020102020200F6300D06092A864886F70D0101050500307E310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F7269747931323030060355040313294170706C652053656375726520426F6F742043657274696669636174696F6E20417574686F72697479301E170D3130313032373232303235315A170D3230313032373232303235315A3053310B300906035504061302555331133011060355040A130A4170706C6520496E632E310C300A060355040B13034554533121301F060355040313184834502D44617277696E2D50726F642D4345504F302D446330819F300D06092A864886F70D010101050003818D003081890281810098AC1FE68ED5EBBC16297C460DADAD1A3A153D85106529E81FAE77915117036EEAB0266550451D50FFBCDAB690990F224461089842C9EA9618AEAC50BC5ACAC258C7BFE185F041D269071DAF30CD7133B34221BF56EFF5A117FDDFBC8A539B484A84545CB8860E24540334769478C4721C78DC8BA52701605F9AF06BAA5096CB0203010001A381EC3081E9300B0603551D0F040403020780301D0603551D0E04160414E1DA15D97BB5ACADFE30DD6640AD3AA52B40EFD4301F0603551D23041830168014493D3653C9D715E186614EACABAB1856635DC3C6308199060A2A864886F763640601010101FF04818704818433676D49840000007000000000000000747265634F5045431C00000004000000010000000000000000000000000000004D4F44531C0000000400000001000000000000000000000000000000444F52501C0000000400000001000000000000000000000000000000504948431C0000000400000040890000000000000000000000000000300D06092A864886F70D010105050003820101001237973B77CFAB8E8CADCB460949A683C6C7BEDA1EE3A03254EFEEE8871F1D9494859A950CDFEBAEE08CB1B17EF11EA6BF6849773A23117C77EA66D45E04E72CD08D41A53F6924001CDA879D622DEAC4557B1468481814DD246EFA546630BF8E90097041A08F7A7FF587D5C63FD0D901C13804C9EA1A7999C40E155AAAF9AB244A0DC82D1AF90A5B7227969DB2B531DB8CC9E72465D9CC79D56E9B6716F413C053102BFE55D4581C68BCC98E3F52E64BAB38B11C7692F31014AFABCC3214DD30117ED9746099C52DDC9302A35F8E8779E6C4D4AC718BAA6E61374FF7C3285DFF7E08ED16168C889DEDF1F56EBDF3B491E591C0948E8D1602856EBF1238C604D4"
    'iPad2,1/iPad2,2/iPad2,3/iPhone4,1 factory certificate
    Public Const s5l8940x_factory_certificate = "CA070000BE070000308203F8308202E0A003020102020110300D06092A864886F70D01010505003062310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F72697479311630140603550403130D4170706C6520526F6F74204341301E170D3037303130353139323135395A170D3232303130353139323135395A307E310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F7269747931323030060355040313294170706C652053656375726520426F6F742043657274696669636174696F6E20417574686F7269747930820122300D06092A864886F70D01010105000382010F003082010A0282010100FEF2DDDA6539B072E3038481F456C9D1A14ABBC80401F3460D95E137950A6947C6C48C793E475506B20614EB7EA4F523FE423598EF3405CE9AD3AD94D0A20FC2D2B404484C235A5BC70B9D62D3F3E36B10FE970857C612767719B2C6C32C98EDB72987E4DC18B6E5F3BA13FBB2B6B767D9CBDF6FA5933DED7A9367B4FD3416E400AB0BB74E1F5AD603683E72B614303A0C6497A04622791B772C5B2E90E011DC16A3E1C8F784B24FDC4B3A0AD5127EDC113FFA1173651A4970A07E7582B43C2B2F55DF3088B1754D45DC07282D4A3A85FD9F953E22BA9C46F7B7687BB394D5423E05B338F86779488C6C1F8BBEEEED5405D5A30B587D780F24A9A1DC0A74EAF70203010001A3819C308199300E0603551D0F0101FF040403020186300F0603551D130101FF040530030101FF301D0603551D0E04160414493D3653C9D715E186614EACABAB1856635DC3C6301F0603551D230418301680142BD06947947609FEF46B8D2E40A6F7474D7F085E30360603551D1F042F302D302BA029A0278625687474703A2F2F7777772E6170706C652E636F6D2F6170706C6563612F726F6F742E63726C300D06092A864886F70D0101050500038201010034C50CC50E59112FA6C29F3278E7643269DBADC225CAB74783B7923C7153A0B2AD30958050BD6D5F4CDCCE780D4C491050381035BF4581AC66582C2123F8965E80E9D3C64CFD85AE3961F628AA44ED159B3F47C057AC671C8CCDD4938D4FDB6A54A77B425B0F99C6D738AB52A7A1831D853074EA0D1DDA68848FE2847ECBB9416ED59FA842B5FF33B6717FEAA3B9DD4903608576103E8EA8E136E312DD856CED6653B05B489B2F7FF6CA1CF05D982D74ADF04847C5E19A67B2220FB00E02A0E1BA6A62B9B4B571F425E1B3E5A0EDC81A40B5F8311505A45C38234C909D47038080D43290458F0FAF9BFC02EEEDCBE631F69F15E67D2B57430EE20FA1A0AD89DA308203BE308202A6A003020102020200F8300D06092A864886F70D0101050500307E310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F7269747931323030060355040313294170706C652053656375726520426F6F742043657274696669636174696F6E20417574686F72697479301E170D3130313032373232303235315A170D3230313032373232303235325A305B310B300906035504061302555331133011060355040A130A4170706C6520496E632E310C300A060355040B13034554533129302706035504031320343531376330646661633435613631373436396633393166656566363964613330819F300D06092A864886F70D010101050003818D003081890281810087B8973443AA68B711A9BF37FF33DA9E889053A21DCE32E660C649A412A890533BB57F65BD86441228A3A9DFE543A6E16059A896B18134EBD849E1277250899BEFFE897C8708D67CB1D67F2B2DF6B6041F654428C904130E795EE8CBC73ABE1027C8AC8D06ED4AFCAF1C0857E99F64DD717A84B7A8C1F2C6E3B3E270EEB5EC6D0203010001A381EC3081E9300B0603551D0F040403020780301D0603551D0E041604143A4310388D0B2B19795D552214B052C7BDCAE09F301F0603551D23041830168014493D3653C9D715E186614EACABAB1856635DC3C6308199060A2A864886F763640601010101FF04818704818433676D49840000007000000000000000747265634F5045431C00000004000000010000000000000000000000000000004D4F44531C0000000400000001000000000000000000000000000000444F52501C0000000400000001000000000000000000000000000000504948431C0000000400000040890000000000000000000000000000300D06092A864886F70D010105050003820101004F63B3D35EC957D1261EE6AD340F8732E0723B51E95DA83F07FF2F9B901BC389A8BF7B0618389EBE52D1DC20AE2BE6DB2ADEDBC00BC3F998C3BCFEE4BC820C43A915ED58224AC20A9FAF73AD382A3F98BA98880320BE6FBA8D16A41401749E4DC76D0DAB8DC8882CE5AB17EEA68AA81D45221C19D74D35C4B17C8C404F3AEAABF1953EC7A11CA66740E6248319842166085FCBB2B5229DF19F2B3B40327C24630568B295E7E08E096A4ED6E45E1EEE0599988D81760EEFA25B6EEC9105BAA0E438F5BFD9FEAACF7CD1167F3788876F2C01A2C2BE89F1D324924C6FE4568AEC2B60FE36AA97C94A0E4119F4EA26C6C369F2FBE8FB847B2544F79C502B8D902FE9"

    Public Shared ifaith_revision As String = String.Empty
    Public Shared ifaith_ios As String = String.Empty
    Public Shared ifaith_build As String = String.Empty
    Public Shared ifaith_boardid As String = String.Empty
    Public Shared ifaith_cert As String = String.Empty
    Public Shared ifaith_ipsw_md5 As String = String.Empty
    Public Shared ifaith_ecid As String = String.Empty
    Public Shared ifaith_apticket As String = String.Empty
    Public Shared ifaith_logo As String = String.Empty
    Public Shared ifaith_chg0 As String = String.Empty
    Public Shared ifaith_chg1 As String = String.Empty
    Public Shared ifaith_batf As String = String.Empty
    Public Shared ifaith_bat0 As String = String.Empty
    Public Shared ifaith_bat1 As String = String.Empty
    Public Shared ifaith_dtre As String = String.Empty
    Public Shared ifaith_glyc As String = String.Empty
    Public Shared ifaith_glyp As String = String.Empty
    Public Shared ifaith_ibot As String = String.Empty
    Public Shared ifaith_illb As String = String.Empty
    Public Shared ifaith_recm As String = String.Empty
    Public Shared ifaith_krnl As String = String.Empty
    Public Shared ifaith_ibss As String = String.Empty
    Public Shared ifaith_ibec As String = String.Empty
    Public Shared ifaith_rdsk As String = String.Empty
    'one day beehind will support ios 3 also...
    Public Shared ifaith_nsrv As String = String.Empty


    Public Shared Function GetItemFromIFaithFile(Infile As String, itemname As String)
        Dim iFaithDocument() As String = IO.File.ReadAllLines(Infile)
        Dim DocumentLength As Integer = iFaithDocument.Length
        Dim CurrentLine As Integer = 0
        Dim result As String = "GOTANYITEM!"
        Do Until CurrentLine = DocumentLength
            If iFaithDocument(CurrentLine).Trim.StartsWith(itemname) Then
                result = (iFaithDocument(CurrentLine).Trim.Replace(itemname, "")).Replace(itemname.Replace("<", "</"), "")
                CurrentLine = CurrentLine + 1
            Else
                CurrentLine = CurrentLine + 1
            End If
        Loop
        Return result.Trim
    End Function

    Public Shared Function GetTheRightCertificate(Infile)
        Dim cert As String = GetItemFromIFaithFile(Infile, "<cert>")
        If iPhoneProcessor = "s5l8720" Then
            'iPod2,1
            If cert = "0x1" Then
                Return s5l8720x_datacenter_certificate
            ElseIf cert = "0x2" Then
                Return s5l8720x_factory_certificate
            End If
        ElseIf iPhoneProcessor.Contains("s5l8920") Then
            'iPhone2,1
            If cert = "0x1" Then
                Return s5l8920x_datacenter_certificate
            ElseIf cert = "0x2" Then
                Return s5l8920x_factory_certificate
            End If
        ElseIf iPhoneProcessor.Contains("s5l8922") Then
            'iPod3,1
            If cert = "0x1" Then
                Return s5l8922x_datacenter_certificate
            ElseIf cert = "0x2" Then
                Return s5l8922x_factory_certificate
            End If
        ElseIf iPhoneProcessor.Contains("s5l8930") Then
            'A4 Device
            If cert = "0x1" Then
                Return s5l8930x_datacenter_certificate
            ElseIf cert = "0x2" Then
                Return s5l8930x_factory_certificate
            End If
        ElseIf iPhoneProcessor.Contains("s5l8940") Then
            'A5 Rev 1 device
            If cert = "0x1" Then
                Return s5l8940x_datacenter_certificate
            ElseIf cert = "0x2" Then
                Return s5l8940x_factory_certificate
            End If
        End If
    End Function

    Public Shared Sub GetIFaithSigature(infile)
        Dim certificate As String = GetTheRightCertificate(infile)
        ifaith_logo = GetItemFromIFaithFile(infile, "<logo>") + certificate
        ifaith_chg0 = GetItemFromIFaithFile(infile, "<chg0>") + certificate
        ifaith_chg1 = GetItemFromIFaithFile(infile, "<chg1>") + certificate
        ifaith_batf = GetItemFromIFaithFile(infile, "<batf>") + certificate
        ifaith_bat0 = GetItemFromIFaithFile(infile, "<bat0>") + certificate
        ifaith_bat1 = GetItemFromIFaithFile(infile, "<bat1>") + certificate
        ifaith_dtre = GetItemFromIFaithFile(infile, "<dtre>") + certificate
        ifaith_glyc = GetItemFromIFaithFile(infile, "<glyc>") + certificate
        ifaith_glyp = GetItemFromIFaithFile(infile, "<glyp>") + certificate
        ifaith_ibot = GetItemFromIFaithFile(infile, "<ibot>") + certificate
        ifaith_illb = GetItemFromIFaithFile(infile, "<illb>") + certificate
        ifaith_recm = GetItemFromIFaithFile(infile, "<recm>") + certificate
        ifaith_krnl = GetItemFromIFaithFile(infile, "<krnl>") + certificate
        ifaith_ibec = GetItemFromIFaithFile(infile, "<ibec>") + certificate
        ifaith_ibss = GetItemFromIFaithFile(infile, "<ibss>") + certificate
        ifaith_rdsk = GetItemFromIFaithFile(infile, "<rdsk>") + certificate
        ifaith_apticket = GetItemFromIFaithFile(infile, "<apticket>")
    End Sub

    Public Shared Sub SignWithIFaith(infile As String)
        GetIFaithSigature(infile)

        If Not ifaith_apticket.Contains("GOTANYITEM") Then
            Beehind.SignIMG3.APTicket = ConvertHexStringToByteArray(ifaith_apticket)
        End If

        If Not ifaith_logo.Contains("GOTANYITEM") Then
            Beehind.SignIMG3.AppleLogo = ConvertHexStringToByteArray(ifaith_logo)
        End If
        If Not ifaith_chg0.Contains("GOTANYITEM") Then
            Beehind.SignIMG3.BatteryCharging0 = ConvertHexStringToByteArray(ifaith_chg0)
        End If
        If Not ifaith_chg1.Contains("GOTANYITEM") Then
            Beehind.SignIMG3.BatteryCharging1 = ConvertHexStringToByteArray(ifaith_chg1)
        End If
        If Not ifaith_batf.Contains("GOTANYITEM") Then
            Beehind.SignIMG3.BatteryFull = ConvertHexStringToByteArray(ifaith_batf)
        End If
        If Not ifaith_bat0.Contains("GOTANYITEM") Then
            Beehind.SignIMG3.BatteryLow0 = ConvertHexStringToByteArray(ifaith_bat0)
        End If
        If Not ifaith_bat1.Contains("GOTANYITEM") Then
            Beehind.SignIMG3.BatteryLow1 = ConvertHexStringToByteArray(ifaith_bat1)
        End If
        If Not ifaith_dtre.Contains("GOTANYITEM") Then
            Beehind.SignIMG3.DeviceTree = ConvertHexStringToByteArray(ifaith_dtre)
        End If
        If Not ifaith_glyc.Contains("GOTANYITEM") Then
            Beehind.SignIMG3.GlyphCharging = ConvertHexStringToByteArray(ifaith_glyc)
        End If
        If Not ifaith_glyp.Contains("GOTANYITEM") Then
            Beehind.SignIMG3.GlyphPlugin = ConvertHexStringToByteArray(ifaith_glyp)
        End If
        If Not ifaith_ibot.Contains("GOTANYITEM") Then
            Beehind.SignIMG3.iBoot = ConvertHexStringToByteArray(ifaith_ibot)
        End If
        If Not ifaith_illb.Contains("GOTANYITEM") Then
            Beehind.SignIMG3.LLB = ConvertHexStringToByteArray(ifaith_illb)
        End If
        If Not ifaith_recm.Contains("GOTANYITEM") Then
            Beehind.SignIMG3.RecoveryMode = ConvertHexStringToByteArray(ifaith_recm)
        End If
        If Not ifaith_krnl.Contains("GOTANYITEM") Then
            Beehind.SignIMG3.KernelCache = ConvertHexStringToByteArray(ifaith_krnl)
        End If
        If Not ifaith_nsrv.Contains("GOTANYITEM") Then
            Beehind.SignIMG3.NeedService = ConvertHexStringToByteArray(ifaith_nsrv)
        End If
        If Not ifaith_ibss.Contains("GOTANYITEM") Then
            Beehind.SignIMG3.iBSS = ConvertHexStringToByteArray(ifaith_ibss)
        End If
        If Not ifaith_ibec.Contains("GOTANYITEM") Then
            Beehind.SignIMG3.iBEC = ConvertHexStringToByteArray(ifaith_ibec)
        End If
        If Not ifaith_rdsk.Contains("GOTANYITEM") Then
            Beehind.SignIMG3.RestoreRamdisk = ConvertHexStringToByteArray(ifaith_rdsk)
        End If
        Beehind.SignIMG3.BlobBackup = Convert.ToBase64String(ConvertHexStringToByteArray(ifaith_illb))
    End Sub

    Public Shared Sub GetInfosFromIFaithFile(infile As String)
        ifaith_revision = GetItemFromIFaithFile(infile, "<revision>")
        Dim iosandbuild As String = GetItemFromIFaithFile(infile, "<ios>")
        ifaith_ios = Strings.Mid(iosandbuild, 1, iosandbuild.IndexOf(" "))
        ifaith_build = Strings.Mid(iosandbuild, iosandbuild.IndexOf("(") + ("(").Length + 1, iosandbuild.IndexOf(")") - iosandbuild.IndexOf("(") - ("(").Length)
        ifaith_boardid = GetItemFromIFaithFile(infile, "<board>")
        ifaith_ipsw_md5 = GetItemFromIFaithFile(infile, "<ipsw_md5>")
        ifaith_ecid = GetItemFromIFaithFile(infile, "<ecid>")
    End Sub

    Public Shared Sub iFaith(infile As String)
        GetInfosFromIFaithFile(infile)
        SignWithIFaith(infile)
    End Sub
End Class
